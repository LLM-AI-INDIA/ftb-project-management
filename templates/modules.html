<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FTB - Enterprise Orchestration Suite</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='mobile.css') }}">
</head>
<body class="bg-white">

<!-- Navbar -->
<nav class="navbar navbar-light bg-white shadow-sm sticky-top" style="height: 85px;">
    <div class="container-fluid d-flex align-items-center" style="height: 75px;">
        <div class="d-flex align-items-center logo-container">
            <a href="{{ url_for('login') }}">
                <img src="{{ url_for('static', filename='llm.png') }}" alt="Logo" style="height:55px; width:auto;">
            </a>
            <a href="javascript:history.back()" class="back-arrow" title="Back">&laquo;</a>
        </div>
        <div class="d-flex">
            <a href="{{ url_for('logout') }}" class="btn btn-outline-danger btn-sm">Logout</a>
        </div>
    </div>
</nav>

<!-- Page Content -->
<div class="container py-5">
    <div class="text-center">
        <img src="{{ url_for('static', filename='icons/' + company_icon) }}" alt="Company Logo" class="company-logo" style="width:20%;height:20%;">
    </div>
    
    <h2 class="text-center dark-blue-text modules-title" style="font-size:2.3rem; font-weight:700; margin-top: 25px; margin-bottom:35px; letter-spacing: -0.5px;">
        Enterprise Orchestration Suite
    </h2>
    
    <div class="horizontal-line" style="height: 4px; width: 90vw; background: #f8f8f8; margin: 30px 0 5px 0; position: relative; left: 50%; right: 50%; transform: translateX(-50%); border: none; margin-bottom: 40px"></div>  

    <!-- Main container with popup support -->
    <div class="light-border modules-container" style="
        border: 2px solid #e1e5e9;
        border-radius: 22px;
        background: #fff;
        padding: 30px 40px;
        margin: 0 auto;
        width: 920px;
        display: block;
        position: relative;"
    >
        <!-- Module Grid -->
        <div class="modules-grid">
            <!-- Enterprise QA with special handling -->
            <div class="module-item dashboard-tile" id="qa-module">
                <div class="text-decoration-none" onclick="toggleQAPopup()" style="cursor: pointer;">
                    <div class="card module-card text-center">
                        <div class="card-body d-flex flex-column align-items-center justify-content-center">
                            <img src="{{ url_for('static', filename='icons/qa.png') }}"
                                 alt="Enterprise QA" class="module-icon">
                            <h5 class="module-name">Enterprise QA</h5>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other modules -->
            {% set other_modules = [
                {"name": "Workflow", "icon": "workflow.png", "route": "oops"},
                {"name": "Transaction", "icon": "transaction.png", "route": "oops"},
                {"name": "Insights", "icon": "insights.png", "route": "insights"},
                {"name": "Data Management", "icon": "datamanagement.png", "route": "oops"},
                {"name": "Voice Agent", "icon": "voiceagent.png", "route": "voice_agent"}
            ] %}

{% for module in other_modules %}
<div class="module-item dashboard-tile">
    {% if module.route.startswith('http') %}
        <a href="{{ module.route }}" target="_blank" class="text-decoration-none">
    {% else %}
        <a href="{{ url_for(module.route) }}" class="text-decoration-none">
    {% endif %}
        <div class="card module-card text-center">
            <div class="card-body d-flex flex-column align-items-center justify-content-center">
                <img src="{{ url_for('static', filename='icons/' + module.icon) }}"
                     alt="{{ module.name }}" class="module-icon">
                <h5 class="module-name">{{ module.name }}</h5>
            </div>
        </div>
    </a>
</div>
{% endfor %}

        <!-- QA Selection Popup -->
        <div id="qa-popup" class="qa-selection-popup" style="display: none;">
            <div class="popup-content">
                <div class="popup-header">
                    <h5>Choose Q&A Type</h5>
                    <button class="close-popup" onclick="closeQAPopup()">&times;</button>
                </div>
                <div class="popup-body">
                    <div class="qa-option" onclick="window.location.href='{{ url_for('qa_projects') }}'">
                        <div class="qa-option-icon">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <div class="qa-option-text">
                            <h6>Project Management</h6>
                            <small>Query project data, budgets, timelines</small>
                        </div>
                    </div>
                    <div class="qa-option" onclick="window.location.href='{{ url_for('qa_operations') }}'">
                        <div class="qa-option-icon">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="qa-option-text">
                            <h6>Operational Q&A</h6>
                            <small>Access operational documents</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* QA Selection Popup Styles */
.qa-selection-popup {
    position: absolute;
    top: 50%;
    right: 100%;
    margin-right: 15px;
    transform: translateY(-50%);
    width: 200px; /* Reduced from 240px */
    background: white;
    border: 2px solid #d1d5db;
    border-radius: 10px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.18);
    z-index: 1000;
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-50%) translateX(20px);
    }
    to {
        opacity: 1;
        transform: translateY(-50%) translateX(0);
    }
}

.popup-content {
    padding: 0;
}

.popup-header {
    background: #667eea;
    color: white;
    padding: 10px 12px; /* Reduced padding */
    border-radius: 8px 8px 0 0;
    display: flex;
    justify-content: center; /* Center the header */
    align-items: center;
    position: relative; /* For absolute positioning of close button */
}

.popup-header h5 {
    margin: 0;
    font-size: 0.85rem; /* Smaller font */
    font-weight: 600;
    text-align: center;
}

.close-popup {
    background: none;
    border: none;
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute; /* Position absolutely */
    right: 8px; /* Position on the right */
}

.close-popup:hover {
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
}

.popup-body {
    padding: 10px; /* Reduced padding */
}

.qa-option {
    display: flex;
    align-items: center;
    padding: 8px; /* Reduced padding */
    border: 1px solid #e9ecef; /* Thinner border */
    border-radius: 6px;
    margin-bottom: 8px; /* Reduced margin */
    cursor: pointer;
    transition: all 0.2s ease;
}

.qa-option:last-child {
    margin-bottom: 0;
}

.qa-option:hover {
    border-color: #c0e6d0;
    background: #f8fffe;
    box-shadow: 0 2px 8px rgba(23, 201, 100, 0.3);
}

.qa-option-icon {
    margin-right: 8px; /* Reduced margin */
    font-size: 1.1rem; /* Smaller icon */
    color: #667eea;
    width: 20px; /* Smaller width */
    text-align: center;
    flex-shrink: 0; /* Prevent shrinking */
}

.qa-option-text h6 {
    margin: 0 0 1px 0;
    font-weight: 600;
    color: #333;
    font-size: 0.75rem; /* Smaller heading */
    line-height: 1.2;
}

.qa-option-text small {
    color: #666;
    font-size: 0.65rem; /* Smaller description text */
    line-height: 1.2;
}

/* Only center on very small screens */
@media (max-width: 768px) {
    .qa-selection-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 250px;
        right: auto;
        margin-right: 0;
    }

    .popup-overlay {
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 999;
    }
}

.popup-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 999;
}

.popup-overlay.show {
    display: block;
</style>

<script>
function toggleQAPopup() {
    const popup = document.getElementById('qa-popup');
    const overlay = document.querySelector('.popup-overlay');
    
    if (popup.style.display === 'none' || popup.style.display === '') {
        popup.style.display = 'block';
        
        // Add overlay for mobile
        if (window.innerWidth <= 768) {
            if (!overlay) {
                const newOverlay = document.createElement('div');
                newOverlay.className = 'popup-overlay';
                newOverlay.onclick = closeQAPopup;
                document.body.appendChild(newOverlay);
            }
            document.querySelector('.popup-overlay').classList.add('show');
        }
    } else {
        closeQAPopup();
    }
}

function closeQAPopup() {
    const popup = document.getElementById('qa-popup');
    const overlay = document.querySelector('.popup-overlay');
    
    popup.style.display = 'none';
    
    if (overlay) {
        overlay.classList.remove('show');
    }
}

// Close popup when clicking outside (for desktop)
document.addEventListener('click', function(e) {
    const popup = document.getElementById('qa-popup');
    const qaModule = document.getElementById('qa-module');
    
    if (popup.style.display === 'block' && 
        !popup.contains(e.target) && 
        !qaModule.contains(e.target)) {
        closeQAPopup();
    }
});
</script>

</body>
</html>
